# Отчет: Этап 2 - Оптимизация архитектуры

**Статус:** `Завершен`

---

## Цель

Провести рефакторинг кода, написанного на Этапе 2, для улучшения его чистоты, надежности и поддерживаемости в соответствии с `AI_GUIDELINES.md`, не добавляя нового функционала.

---

## План действий

1.  **Централизация типов с помощью Prisma:**
    - **Действие:** Заменить все вручную созданные `interface` для моделей данных (например, `Question`) на типы, автоматически сгенерированные Prisma (`import type { ... } from '@prisma/client'`).
    - **Статус:** `Выполнено`

2.  **Рефакторинг логики получения данных:**
    - **Действие:** Перенести логику прямого доступа к `prisma` со страниц (`ProgramPage`, `SectionPage`) в соответствующие файлы `actions.ts` в модулях. Страницы должны вызывать эти экшены, а не `prisma` напрямую.
    - **Статус:** `Выполнено`

3.  **Централизация управления путями (Routes):**
    - **Действие:** Создать файл `src/lib/paths.ts`, который будет экспортировать функции для генерации всех URL-адресов в приложении (например, `paths.program(id)`). Заменить жестко прописанные пути в компонентах (`<Link>`) на вызовы этих функций.
    - **Статус:** `Выполнено`

---

## Ожидаемые изменения в файловой системе

- **Новые файлы:**
    - `docs/reports/stage-2-optimization.md`
    - `src/lib/paths.ts`
- **Измененные файлы:**
    - `src/modules/questions/components/QuestionList.tsx` (обновление типов)
    - `src/modules/programs/lib/actions.ts` (добавление `getProgramById`)
    - `src/app/programs/[id]/page.tsx` (рефакторинг доступа к данным и путей)
    - `src/app/sections/[id]/page.tsx` (рефакторинг доступа к данным и путей)
    - `src/modules/programs/components/ProgramList.tsx` (обновление путей)
    - `src/modules/sections/components/SectionList.tsx` (обновление путей)
