# Отчет: Этап 3.4 - UI: Компонент QuizQuestion и обратная связь

**Статус:** `Завершен`

---

## Цель

Создать компонент `QuizQuestion` для отображения одного вопроса и его вариантов ответа. Интегрировать его в `QuizView` и реализовать логику обратной связи: вызов Server Action `submitAnswer` при выборе ответа, подсветку правильных/неправильных вариантов и блокировку кнопок после ответа.

---

## План действий

1.  **Создание файла компонента `QuizQuestion`:**
    - **Действие:** Создать новый файл `src/modules/quiz/components/QuizQuestion.tsx`.

2.  **Реализация компонента `QuizQuestion`:**
    - **Props:** Компонент будет принимать:
        - `question`: Объект с данными вопроса.
        - `onAnswerSubmit`: Callback-функция, которая будет вызываться с результатом ответа.
    - **Логика:**
        - Отобразить текст вопроса.
        - Преобразовать JSON-строку с ответами в массив и отобразить его в виде кнопок.
        - Управлять состоянием `submittedAnswer`, в котором будет храниться `{ selectedIndex: number; isCorrect: boolean; correctAnswerIndex: number; }`.
        - При клике на кнопку ответа:
            1. Вызвать `submitAnswer` с `question.id` и индексом ответа.
            2. Сохранить результат в состояние `submittedAnswer`.
            3. Вызвать `onAnswerSubmit`, чтобы родительский компонент (`QuizView`) узнал, что ответ был дан.
    - **Стилизация:** Применить условные стили для кнопок в зависимости от состояния `submittedAnswer`:
        - Если ответ дан:
            - Выбранный неправильный ответ: подсветить красным.
            - Правильный ответ: подсветить зеленым.
        - Все кнопки должны быть заблокированы (`disabled`) после ответа.

3.  **Интеграция в `QuizView.tsx`:**
    - **Действие:** Открыть существующий файл `src/modules/quiz/components/QuizView.tsx`.
    - **Логика:**
        - Заменить текущее отображение текста вопроса на компонент `<QuizQuestion />`.
        - Передать в него `currentQuestion` и `handleAnswerSubmitted`.
        - Создать состояние `isAnswerSubmitted` и функцию `handleAnswerSubmitted`, которая будет устанавливать это состояние в `true`.
        - Сделать кнопку "Далее" активной только тогда, когда `isAnswerSubmitted` равно `true`.
        - При переходе к следующему вопросу (нажатии "Далее") сбрасывать `isAnswerSubmitted` в `false`.

4.  **Экспорт компонента:**
    - **Действие:** Убедиться, что `QuizQuestion` экспортируется из `src/modules/quiz/index.ts`.

---

## Ход выполнения

1.  **Создание `QuizQuestion.tsx`:** Успешно создан файл. Компонент реализован для отображения вопроса, обработки кликов по ответам и вызова `submitAnswer`. В нем используется внутреннее состояние для управления подсветкой и блокировкой кнопок после ответа.
2.  **Интеграция в `QuizView.tsx`:**
    - Компонент `QuizView` был обновлен для использования `<QuizQuestion />`.
    - Добавлено новое состояние `isAnswerSubmitted`, которое обновляется через callback-функцию `onAnswerSubmit`.
    - Кнопки навигации "Далее" и "Завершить" теперь становятся активными только после того, как пользователь дал ответ на текущий вопрос.
    - При переходе к следующему вопросу состояние `isAnswerSubmitted` сбрасывается.
3.  **Экспорт:** Компонент `QuizQuestion` был успешно добавлен в `index.ts` модуля `quiz`.

**Итог:** Этап успешно завершен. UI для прохождения теста теперь интерактивен, обеспечивает обратную связь пользователю и готов к реализации финального экрана с результатами.

---

### **Ход выполнения (исправление)**

-   **Проблема:** Была обнаружена ошибка компиляции из-за конфликта имен. И тип данных для вопроса (`QuizQuestion`), и React-компонент (`QuizQuestion`) имели одинаковое имя, что приводило к неоднозначности при экспорте из `index.ts`.
-   **Решение:**
    1.  Тип данных в `src/modules/quiz/lib/actions.ts` был переименован в `QuizQuestionData`.
    2.  Импорты и использование этого типа были обновлены в компонентах `QuizView.tsx` и `QuizQuestion.tsx`.
-   **Результат:** Конфликт имен был устранен, ошибка компиляции исправлена.
