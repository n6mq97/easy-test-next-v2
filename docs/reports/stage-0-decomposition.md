# Декомпозиция задач: Этап 0 - Фундамент

Этот документ детализирует задачи, необходимые для завершения Этапа 0 "Фундамент" из основного плана разработки.

---

### 1. Инициализация проекта Next.js

*Цель: Убедиться, что проект корректно настроен и запускается.*

- [ ] **Проверка зависимостей:** Выполнить `npm install` (или `yarn`), чтобы убедиться, что все зависимости установлены.
- [ ] **Тестовый запуск:** Запустить сервер разработки с помощью `npm run dev` и проверить, что стартовая страница открывается в браузере без ошибок.

---

### 2. Установка и настройка Prisma

*Цель: Интегрировать Prisma ORM для работы с базой данных.*

- [ ] **Установка Prisma CLI:** Добавить Prisma в dev-зависимости проекта: `npm install prisma --save-dev`.
- [ ] **Инициализация Prisma:** Выполнить команду `npx prisma init --datasource-provider sqlite`. Это создаст:
    - директорию `prisma` с файлом `schema.prisma`.
    - файл `.env` для переменных окружения.
- [ ] **Настройка файла `.env`:** Указать путь к файлу базы данных: `DATABASE_URL="file:./dev.db"`.
- [ ] **Создание клиента Prisma:** Создать файл `src/lib/prisma.ts` для инициализации и экспорта единственного экземпляра клиента Prisma, чтобы избежать множественных подключений к БД.

---

### 3. Определение моделей данных в `prisma/schema.prisma`

*Цель: Описать всю схему данных приложения в соответствии с `README.md`.*

- [ ] **Определить модель `User`:**
    - `id`, `name`, `password` (с учетом будущего хеширования), `role`.
- [ ] **Определить перечисление `Role`:**
    - `USER`, `ADMIN`.
- [ ] **Определить модель `Program`:**
    - `id`, `name`, `theory` и связь с `User`.
- [ ] **Определить модель `Section`:**
    - `id`, `name`, `theory` и связь с `Program`.
- [ ] **Определить модель `Question`:**
    - `id`, `questionText`, `answers` (массив строк), `correctAnswerIndex` и связь с `Section`.
- [ ] **Определить модель `AnswerResult` (вместо `TestResult` для большей точности):**
    - `id`, `isCorrect` и связи с `User` и `Question` для записи каждого ответа.
- [ ] **Прописать все связи (`@relation`)** между моделями (`User` <-> `Program`, `Program` <-> `Section`, и т.д.).

---

### 4. Создание и применение первой миграции

*Цель: Создать физическую структуру базы данных на основе схемы Prisma.*

- [ ] **Форматирование схемы:** Выполнить `npx prisma format` для автоматического форматирования `schema.prisma`.
- [ ] **Создание миграции:** Запустить команду `npx prisma migrate dev --name init`. Эта команда:
    - Создаст SQL-файл миграции в `prisma/migrations`.
    - Применит миграцию, создав файл `dev.db`.
    - Сгенерирует Prisma Client для работы с моделями.
- [ ] **Проверка генерации клиента:** Убедиться, что в `node_modules/@prisma/client` появились актуальные типы данных.

---

### 5. Настройка базовых стилей с Tailwind CSS

*Цель: Подготовить основу для UI в соответствии с требованиями `README.md`.*

- [ ] **Установка зависимостей:** Установить `tailwindcss`, `postcss`, `autoprefixer`.
- [ ] **Инициализация Tailwind:** Создать файлы `tailwind.config.js` и `postcss.config.js` командой `npx tailwindcss init -p`.
- [ ] **Настройка `tailwind.config.js`:** В `content` указать пути к файлам проекта: `./src/**/*.{js,ts,jsx,tsx,mdx}`.
- [ ] **Подключение стилей:** Добавить директивы `@tailwind` в `src/app/globals.css`.
- [ ] **Настройка глобального layout (`src/app/layout.tsx`):**
    - Применить базовые стили к `<body>`, такие как фон, цвет текста и основной шрифт, чтобы соответствовать "черно-белой" теме.
    - Настроить базовую разметку для центрирования контента на странице.

---

### 6. Настройка Docker для развертывания

*Цель: Подготовить конфигурацию для сборки и запуска приложения в Docker-контейнере.*

- [ ] **Создание `.dockerignore`:**
    - Создать файл `.dockerignore` в корне проекта, чтобы исключить из образа ненужные файлы и директории (например, `node_modules`, `.next`, `.git`, `.env`).
- [ ] **Создание `Dockerfile`:**
    - Создать `Dockerfile` в корне проекта.
    - Описать многоэтапную сборку (multi-stage build) для оптимизации размера итогового образа:
        - **Этап `dependencies`:** Установка зависимостей.
        - **Этап `builder`:** Копирование кода и сборка Next.js-приложения (`npm run build`).
        - **Финальный этап:** Копирование результатов сборки из `builder` и запуск приложения.
- [ ] **Тестовая сборка образа:**
    - Выполнить команду `docker build -t easy-test .` для проверки, что образ собирается без ошибок.
